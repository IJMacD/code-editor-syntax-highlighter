function e(e,{tokenizer:t,plugins:i=[n,s,o]}={}){if("string"==typeof e){const t=document.querySelector(e);t&&(e=t)}if(!(e&&e instanceof HTMLTextAreaElement))return void console.warn("[Editor] Couldn't find element or element wasn't a textarea");const l=e.parentElement;if(!l)return void console.warn("[Editor] Element didn't have a parent");const c=e,a=document.createElement("div");a.classList.add("cesh-editor"),c.classList.add("cesh-textarea"),l.style.position="relative",l.insertBefore(a,e);const u=()=>{let e=c.value;const n=t?t(e):[];"\n"===e[e.length-1]&&(e+=" "),a.innerHTML=r(e,n),a.scrollTop=c.scrollTop},E=()=>{a.scrollTop=c.scrollTop};c.addEventListener("keyup",u),c.addEventListener("input",u),c.addEventListener("scroll",E);const d=()=>{a.style.width=`${c.offsetWidth}px`,a.style.height=`${c.offsetHeight}px`,a.style.position="absolute"},f=new ResizeObserver(d);f.observe(c),d(),u();const v=[];for(const e of i){const t=e(c);t&&v.push(t)}return{destroy(){l.removeChild(a),c.classList.remove("cesh-textarea"),c.removeEventListener("keyup",u),c.removeEventListener("input",u),c.removeEventListener("scroll",E),f.disconnect();for(const e of v)e()}}}function t(e,t){const n=e.lastIndexOf("\n",t-1);return n<0?0:n+1}function n(e){const n=n=>{if("Tab"===n.key){n.preventDefault();const s=e.selectionStart,{value:o}=e;if(n.shiftKey){const n=t(o,s);"    "===o.substring(n,n+4)&&(e.value=o.substring(0,n)+o.substring(n+4),e.selectionStart=s-4,e.selectionEnd=s-4)}else e.value=o.substring(0,s)+"    "+o.substring(s),e.selectionStart=s+4,e.selectionEnd=s+4}};return e.addEventListener("keydown",n),()=>e.removeEventListener("keydown",n)}function s(e){const n=n=>{if("Enter"===n.key){const s=e.selectionStart,{value:o}=e,r=t(o,s),i=/ +/gy;i.lastIndex=r;const l=i.exec(o);if(l){n.preventDefault();const t=l[0].length;e.value=o.substring(0,s)+"\n"+" ".repeat(t)+o.substring(s),e.selectionStart=s+t+1,e.selectionEnd=s+t+1}}};return e.addEventListener("keydown",n),()=>e.removeEventListener("keydown",n)}function o(e){const t=t=>{const n={"'":"'",'"':'"',"(":")","{":"}","[":"]"};if(n[t.key]){const s=e.selectionStart,o=e.selectionEnd;if(o-s>0){t.preventDefault();const{value:r}=e;e.value=r.substring(0,s)+t.key+r.substring(s,o)+n[t.key]+r.substring(o),e.selectionStart=s+1,e.selectionEnd=o+1}}};return e.addEventListener("keydown",t),()=>e.removeEventListener("keydown",t)}function r(e,t){const n=[];let s=0;for(const o of t)o.start>s&&n.push(e.substring(s,o.start)),s=o.start+o.length,n.push(`<span class="${o.type}">${e.substring(o.start,s)}</span>`);return s<e.length&&n.push(e.substring(s)),n.join("")}function i(e){const t={keyword:/SELECT|DISTINCT|FILTER|FROM|LEFT|RIGHT|INNER|OUTER|FULL|JOIN|ON|WHERE|ORDER BY|AS|OVER|PARTITION BY|UNBOUNDED|PRECEDING|FOLLOWING|FETCH|FIRST|NEXT|ROW|ROWS|WINDOW|HAVING|LIMIT|OFFSET|CREATE|TEMP|TABLE|VIEW|INSERT INTO|VALUES|UPDATE|SET|DELETE/gy,number:/-?\d+(\.\d+)?/gy,name:/\w+|"[^"]*"/gy,string:/'[^']*'/gy,punctuation:/\*|,|\(|\)/gy},n=[];for(let s=0;s<e.length;){let o;for(const[r,i]of Object.entries(t))if(i.lastIndex=s,o=i.exec(e)){const e=o[0].length;n.push({type:r,start:s,length:e}),s+=e;break}o||s++}return n}export{e as editor,s as enterPlugin,r as markup,o as quotesPlugin,i as sqlTokenizer,n as tabPlugin};
